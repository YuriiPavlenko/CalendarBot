<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Настройки и встречи</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
<style>
  body {
    background: linear-gradient(120deg, #f0f3f4, #a9c9ff);
    min-height: 100vh;
    padding: 20px;
  }
  .meeting-card {
    background: #fff;
    border-radius: 5px;
    padding:10px;
    margin-bottom:10px;
    box-shadow: 0 2px 5px rgba(0,0,0,.1);
  }
  h2 {
    margin-top: 30px;
  }
</style>
</head>
<body>
<div class="container">
  <h1 class="my-4 text-center">Настройки и встречи</h1>
  <p>Пользователь ID: {{user_id}}</p>

  {% if settings_saved %}
    <div class="alert alert-success alert-dismissible fade show" role="alert">
      Настройки сохранены успешно.
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  {% endif %}

  <div class="card mb-4">
    <div class="card-body">
      <h2 class="h4 mb-3">Настройки</h2>
      <form action="/save?user_id={{user_id}}" method="post">
        <h3 class="h5 mb-2">Фильтр встреч</h3>
        <div class="form-check mb-2">
          <input class="form-check-input" type="radio" name="filter_type" value="all" {% if filter_type=='all' %}checked{% endif %}>
          <label class="form-check-label">Показывать все встречи</label>
        </div>
        <div class="form-check mb-3">
          <input class="form-check-input" type="radio" name="filter_type" value="mine" {% if filter_type=='mine' %}checked{% endif %}>
          <label class="form-check-label">Показывать только мои встречи</label>
        </div>

        <h3 class="h5 mb-2">Уведомления</h3>
        <div class="form-check mb-1">
          <input class="form-check-input" type="checkbox" name="notify_1h" {% if notify_1h %}checked{% endif %}>
          <label class="form-check-label">За 1 час</label>
        </div>
        <div class="form-check mb-1">
          <input class="form-check-input" type="checkbox" name="notify_15m" {% if notify_15m %}checked{% endif %}>
          <label class="form-check-label">За 15 минут</label>
        </div>
        <div class="form-check mb-1">
          <input class="form-check-input" type="checkbox" name="notify_5m" {% if notify_5m %}checked{% endif %}>
          <label class="form-check-label">За 5 минут</label>
        </div>
        <div class="form-check mb-3">
          <input class="form-check-input" type="checkbox" name="notify_new" {% if notify_new %}checked{% endif %}>
          <label class="form-check-label">При добавлении новой встречи</label>
        </div>

        <button type="submit" class="btn btn-primary btn-lg btn-block">Сохранить</button>
      </form>
    </div>
  </div>

  <h2 class="h4 mb-3">Встречи</h2>
  {% if meetings and meetings|length > 0 %}
    {% for m in meetings %}
    <div class="meeting-card">
      <strong>{{m.title}}</strong><br>
      Украина: {{m.start_ua.strftime("%Y-%m-%d %H:%M")}} - {{m.end_ua.strftime("%Y-%m-%d %H:%M")}}<br>
      Таиланд: {{m.start_th.strftime("%Y-%m-%d %H:%M")}} - {{m.end_th.strftime("%Y-%m-%d %H:%M")}}<br>
      {% if m.attendants %}
        Участники: {{m.attendants.split(', ')|join(', ')}}<br>
      {% endif %}
      {% if m.hangoutLink %}
        Ссылка: <a href="{{m.hangoutLink}}" target="_blank">Открыть</a><br>
      {% endif %}
      {% if m.location %}
        Место: {{m.location}}<br>
      {% endif %}
      {% if m.description %}
        Описание: {{m.description}}<br>
      {% endif %}
    </div>
    {% endfor %}
  {% else %}
    <p>Нет предстоящих встреч.</p>
  {% endif %}
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
